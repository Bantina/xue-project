/*******************************************
 *
 * 新鲜事所有事件绑定功能
 * @authors Du xin li
 * @date    2015-10-22
 * @version $Id$
 *
*********************************************/

$(function(){

	//动态大小图片切换功能
	$('.fresh-list').off('click', '.fresh-type-img').on('click', '.fresh-type-img', function(){
		fresh.media.img.toggle(this);
	})
	
	// 动态中点击“作答”切换做题效果
    $('.fresh-list').off('click', '.fresh-answer-btn').on('click', '.fresh-answer-btn', function(){
        fresh.media.answer.btnToggle(this);
    });

    // 点击动态试题图片切换方法
    $('.fresh-list').off('click', '.fresh-type-answer').on('click', '.fresh-type-answer', function(e){
        fresh.media.answer.imgToggle(this, e);
    });

    // 选择动态试题答案：提交答案
    $('.fresh-list').off('click', '.fresh-big-selectAnswer a[data-type="radio"]').on('click', '.fresh-big-selectAnswer a[data-type="radio"]', function(){
        fresh.media.answer.answerSubmit(this);
    });
    
    //点击视频小图显示视频大图效果
    $('.fresh-list').off('click', '.fresh-type-video .fresh-media-small-video').on('click', '.fresh-type-video .fresh-media-small-video', function(){
        fresh.media.video.videoPlay(this);
    });
   
    //点击视频大图上的收起显示小图视频效果
    $('.fresh-list').off('click', '.fresh-packUp-video').on('click', '.fresh-packUp-video', function(){
         fresh.media.video.videoHide(this);
    });


    /* ================= 评论相关 ============= */

    //点击父级评论按钮切换评论框区域和消息
    $('.fresh-list').off('click', '.fresh-comment-expand-btn').on('click', '.fresh-comment-expand-btn', function(){
         fresh.comment.toggle(this);
    });

    //点击关闭评论框按钮
    $('.fresh-list').off('click', '.fresh-comment-close-btn').on('click', '.fresh-comment-close-btn', function(){
         fresh.comment.close(this);
    });

    //限制文本域字数显示
    $('.fresh-list').off('input keyup paste focus', '.fresh-comment-textarea textarea').on('input keyup paste focus', '.fresh-comment-textarea textarea', function(){
        var that = this;
        setTimeout(function(){
            fresh.comment.textareaNum(that);
        }, 10);
    });

    //点击发布评论内容按钮
    $('.fresh-list').off('click', '.fresh-comment-submit-btn a').on('click', '.fresh-comment-submit-btn a', function(){
        fresh.comment.sendComment(this);
    });

    // 点击评论列表里回复区域评论切换
    $('.fresh-list').off('click', '.fresh-comment-list .fresh-barinfo a').on('click', '.fresh-comment-list .fresh-barinfo a', function(){
        if(!$(this).hasClass('fresh-del-msg')){
            fresh.comment.replyToggle(this);
        }

    });

    // 点击表情按钮,弹出表情弹出层
    $('.fresh-list').off('click', '.fresh-comment-emote-btn').on('click', '.fresh-comment-emote-btn', function(event){
         fresh.comment.emote(this, event);
    });

    //点击删除新鲜事和评论的删除
    $('.fresh-list').off('click', '.fresh-barinfo a.fresh-del-msg').on('click', '.fresh-barinfo a.fresh-del-msg', function(){
         fresh.comment.delComment(this);
    });


    /* ================= 收藏相关 ============= */
    
    //点击添加收藏按钮
     $('.fresh-list').off('click', '.fresh-collect-add-btn').on('click', '.fresh-collect-add-btn', function(){
         fresh.collect.add(this);
    });

    //点击取消收藏按钮
    $('.fresh-list').off('click', '.fresh-collect-cancel-btn').on('click', '.fresh-collect-cancel-btn', function(){
         fresh.collect.cancel(this);
    });
    
    

    /* ================= 发布新鲜事相关 ============= */

    //限制发布新鲜事文本域字数显示
    $('body').off('input keyup paste focus', '.fresh-send-textareaBox').on('input keyup paste focus', '.fresh-send-textareaBox', function(){
        var that = this;
        setTimeout(function(){
            fresh.send.limitNum(that);
        }, 10);
    });

    // 点击表情按钮,弹出表情弹出层
    $('body').off('click', '.fresh-send-emote').on('click', '.fresh-send-emote', function(event){
         fresh.comment.emote(this, event, 'send');
    });

    // 发布新鲜事里面的选择上传图片
    $('body').off('change', '.fresh-send-form #fresh-fileToUpload').on('change', '.fresh-send-form #fresh-fileToUpload', function(){
        fresh.send.fileupload(this);
    });

    //点击关闭图片区域按钮
    $('body').off('click', '.fresh-send-box .fresh-preview-close').on('click', '.fresh-send-box .fresh-preview-close', function(){
        $('#fresh-send-preview').addClass('hide');
    });

    //点击发送新鲜事按钮应该是弹出层
    $('body').off('click', ' #freshPost').on('click', '#freshPost', function(){
        fresh.send.box(this);
    })

    //点击发送按钮刷新整个页面
    $('body').off('click', '.fresh-send-box .fresh-send-submit-btn').on('click', '.fresh-send-box .fresh-send-submit-btn', function(){
        window.location.reload();
    })
   
})

